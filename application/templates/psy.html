{% extends "base.html" %}
{% block scripts %}
    <script src="{{ url_for('static', filename='universal.js') }}" type="text/javascript"></script>
    <script src="{{ url_for('static', filename='psy.js') }}" type="text/javascript"></script>
{% endblock %}
{% block stylesheet %}
    <style>
        .sortKey {
            cursor: pointer;
            text-decoration: underline;
        }
        #statsCardTitle {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            width: 58%;
            display: inline-block;
       }
    </style>
{% endblock %}
{% block body %}
    <div class="row">
        <div class="col-md-6">
            <div class="card border-0 shadow" id="add_testees_card">
                <div class="card-body">
                    <form id="addTesteesForm">
                        <h5 class="card-title"><span id="psyFormTitle">Добавить испытуемых</span>
                            <span id="formSignSuc" class="badge badge-pill badge-success pull-right" style="display: none">
                                <i class="fa fa-check" aria-hidden="true"></i>Успешно</span>
                            <br>
                            Доступно <span id="countPlace"></span>
                        </h5>

                        <div class="form-group">
                            <label for="addFormName">Класс</label>
                            <input class="form-control" id="addFormName" type="text" name="grade"  oninput="validateFormData()">
                            <div id="addFormNameMsg" class="invalid-feedback"></div>
                        </div>
                        <div class="form-group">
                            <label for="addFormCount">Количество</label>
                            <input class="form-control" id="addFormCount" type="number" min="1" name="count" oninput="validateFormData()">
                            <div id="addFormCountMsg" class="invalid-feedback"></div>
                        </div>

                        <div class="form-group">
                            <input type="button" id="addFormBtnAdd" class="btn btn-success" value="Добавить испытуемых" onclick="addTestees()" disabled>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card border-0 shadow mt-md-0 mt-2">
                <div class="card-body">
                    <div class="card-title"><h5 id="statsCardTitle">Общая статистика</h5>
                        <div style="display: inline-block" class="pull-right">
                            <i id="loadingIcon" class="fa fa-spinner fa-pulse fa-1x fa-fw"></i>
                            <span id="statsCardBtnDownload" class="btn badge badge-pill btn-outline-success mr-1">
                                <i class="fa fa-arrow-circle-down" aria-hidden="true"></i>
                                Скачать
                            </span>
                            <span id="statsCardBtnRefresh" class="btn badge badge-pill btn-outline-success mr-0">
                                <i class="fa fa-refresh" aria-hidden="true"></i>
                                Обновить
                            </span>
                        </div>
                    </div>

                     {% include 'stats.html' %}
                </div>
            </div>
        </div>
    </div>



    <span id="fatalMsg" class="badge badge-danger"></span>


    <div id="gradeTablePlace">
        <h3 id="gradeTableTitle" class="display-4 mt-5">Список классов</h3>
        <div class="table-responsive">
            <table id="gradeTable" class="table text-center">
                <thead>
                <tr>
                    <th class="sortKey" onclick="showGrades('name')">Класс</th>
                    <th class="sortKey" onclick="showGrades('whole')">Общее Кол-во</th>
                    <th class="sortKey" onclick="showGrades('not_yet')">Нет результата</th>
                    <th class="sortKey" onclick="showGrades('clear')">Не рискуют</th>
                    <th class="sortKey" onclick="showGrades('danger')">Рискуют</th>
                </tr>
                </thead>
            </table>
        </div>
    </div>

    <div id="testeeTablePlace" style="display: none">
        <h3 id="testeeTableTitle" class="display-4 mt-5">Список испытуемых <span id="gradeName"></span></h3>
        <div class="table-responsive">
            <table id="testeeTable" class="table text-center">
                <thead>
                    <tr>
                        <th class="sortKey" onclick="showTestees('result')">Результат</th>
                        <th class="sortKey" onclick="showTestees('login')">Логин</th>
                        <th>Пароль</th>
                        <th class="sortKey" onclick="showTestees('create_date')">Дата создания</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>

{% endblock %}
